\chapter{The fifteen theorem}
\label{chap:conway-schneeberger}

{\scshape We now} come to the main result of this essay, the Conway-Schneeberger
fifteen theorem. 

\section{Escalators of small dimension}

\subsection{}~We have earlier established the existence of a natural bijection
between the set of equivalence classes of positive-definite integral quadratic
forms and the set of integral lattices. We shall exploit this fact and oscillate
between the two notions as we see fit, writing \(\Lattice_q\) for the lattice
corresponding to the form \(q\). Now recall also that we say a quadratic form is
universal if it represents all positive integers. We shall limit our attention
to finding a universality criterion for positive-definite integral quadratic
forms. Some new definitions are in order. Given a form \(q\) (and its
corresponding lattice \(\Lattice_q\)), we define the \emph{truant} of \(q\) to
be the least positive integer \(n\) such that \(n\) is not represented by \(q\).
We denote this by \(\tau(q)\). An escalation of a non-universal lattice
\(\Lattice\) is a lattice \(\Lattice'\) generated by \(\Lattice\) and a vector
whose norm is \(\tau(q)\). Any sequence of successive escalations of the
zero-dimensional lattice is called an \emph{escalator lattice}.

We can escalate the zero-dimensional lattice uniquely to the lattice generated
by a single vector of norm \(1\). This lattice has matrix form \((1)\) and
correspond to the form \(x^2\). Since \(x^2\) does not represent \(2\), we have
\(\tau(x^2) = 2\) and we obtain the escalator lattice corresponding to the form
\[
    \begin{pmatrix}
        1 & a \\
        a & 2
    \end{pmatrix}.
\]
By the Cauchy-Schwarz inequality, we have \(a^2 \leq 2\) and thus \(a\) is one
of \(0\), \(1\) or \(-1\). We thus obtain the following lattices:
\[
    \begin{pmatrix}
        1 & 0 \\
        0 & 2
    \end{pmatrix}, \quad
    \begin{pmatrix}
        1 & 1 \\
        1 & 2
    \end{pmatrix}, \quad
    \begin{pmatrix}
        1 & -1 \\
        -1 & 2
    \end{pmatrix}.
\]
These lattices correspond to the form \(x^2 + 2y^2\), \(x^2 + 2xy + y^2\) and
\(x^2 - 2xy + y^2\), respectively. By Theorem \ref{thm:bound-on-minimum-hermite}
of \S\,\ref{sec:minimum} and the more general results of
\S\,\ref{sec:minkowski-criterion}, we have
\[
    x^2 + 2xy + y^2 \sim x^2 - 2xy + y^2 \sim x^2 + y^2,
\]  
and thus we need only consider the two non-isometric binary escalator lattices
\[
    \begin{pmatrix}
        1 & 0 \\
        0 & 2
    \end{pmatrix}, \quad
    \begin{pmatrix}
        1 & 0 \\
        0 & 1
    \end{pmatrix},
\]
corresponding to the forms \(x^2 + 2y^2\) and \(x^2 + y^2\), respectively.
Continuing in the same vein, we can escalate both lattices and obtain nine
non-isometric ternary escalator lattices, whose Minkowski-reduced forms are
\[
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 1 & 0 \\
        0 & 0 & 1
    \end{pmatrix}, \quad
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 1 & 0 \\
        0 & 0 & 2
    \end{pmatrix}, \quad
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 1 & 0 \\
        0 & 0 & 3
    \end{pmatrix},
\]
\[
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 2 & 0 \\
        0 & 0 & 2
    \end{pmatrix}, \quad
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 2 & 0 \\
        0 & 0 & 3
    \end{pmatrix}, \quad
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 2 & 1 \\
        0 & 1 & 4
    \end{pmatrix},
\]
\[
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 2 & 0 \\
        0 & 0 & 4
    \end{pmatrix}, \quad
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 2 & 1 \\
        0 & 1 & 5
    \end{pmatrix}, \quad
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 2 & 0 \\
        0 & 0 & 5
    \end{pmatrix}.
\]
The first of these lattices corresponds to the form \(x^2 + y^2 + z^2\), which
we have established in \(\S\,\ref{sec:sum-of-squares}\) to be non-universal. An
examination of the other eight lattices can be found in
\cite{dickson1927integers}.
 
\subsection{}~Escalating each of the nine ternary escalator lattices, we obtain
a total of 207 non-isometric four-dimensional positive-definite escalator
lattices. All such lattices are of the form \(1 \oplus \Lattice\) list these
lattices in the Appendix.

We shall now show that all but six of these escalators are universsal and cannot
be escalated further. The proof of the universality of each four-dimensional
escalator is as follows: For each four-dimensional escalator lattice
\(\Lattice_4\) we find a three-dimesional sublattice \(\Lattice_3\) which
represents some large set of integers. We achieve this typically by choosing
\(\Lattice_3\) to be unique in its genus, in which case it represents all
integers that it represents over each \(\Integers_p\). (The existence of such
integral representation in the genus of \(\Lattice_3\) is the result of
Theorem~\ref{thm:genus-existence-2} of \S\,\ref{sec:genus-existence}.) We then
show that \(\Lattice_4\) is the direct sum of \(\Lattice_3\) and its orthogonal
complement in \(\Lattice_4\) and represents all sufficiently large integers \(n
\geq N\). A direct check of the remaining integers \(1 \leq n < N\) then shows
that \(\Lattice_4\) is universal.

The argument relies on finding a suitable three-dimensional sublattice
\(\Lattice_3 \subset \Lattice_3\) and can be more properly illustrated by
example. Consider the lattice \(\Lattice_3\) with the Gram matrix
\[
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 2 & 0 \\
        0 & 0 & 2
    \end{pmatrix}.
\]
(This is labelled (4) in \cite[Table~1]{bhargava2000conway}.) As we have shown
in \S\,\ref{sec:genus-existence}, \(\Lattice_3\) is unique in its genus. By
calculations performed locally for \(\Lattice_3\), this lattice represents all
positive integers except those of the form \(2^e (8k + 7)\) for even \(e\). Let
\((m)\) be the \(1\)-dimesional orthogonal complement of \(\Lattice_3\) in
\(\Lattice_4\). We now wish to show that \(\Lattice_3 \oplus (m)\) represents
all sufficiently large integers.

Suppose that \(\Lattice_4\) is not universal and let \(\tau\) be the truant of
\(\Lattice_4\). Since the direct sum \(\Lattice_3 \oplus (m)\) lies in
\(\Lattice_4\), it must be of the form \(2^e(8k+7)\). Moreover, \(\tau\) is
square-free (otherwise, \(\tau = rt^2\) for \(t > 1\) and \(r < \tau\) is thus
not represented by \(\Lattice_3\), contradicting our definition of the truant
\(\tau\)). From this it follows that \(\tau \equiv 7 \pmod{8}\).

Now if \(m \equiv 0\), \(3\) or \(7 \pmod{8}\), then \(\tau - m\) is not of the
form \(2^e(8k+7)\); similarly, if \(m \equiv 3\) or \(7 \pmod{8}\), then \(\tau
- 4m\) is not of the form \(2^e(8k+7)\). thus if \(m \not\equiv 0 \pmod{8}\) and
since \(\tau \geq 4m\), then either \(\tau - m\) or \(\tau - 4m\) is represented
by \(\Lattice_3\). By direct calculation, we find that \(m \leq 28\) for all the
\(26\) escalations of \(\Lattice_3\). For example one of the escalations of
\(\Lattice_3\) is the lattice with Gram matrix
\[
    \begin{pmatrix}
        1 & 0 & 0 & 0 \\
        0 & 2 & 0 & 0 \\
        0 & 0 & 2 & 1 \\
        0 & 0 & 1 & 7
    \end{pmatrix}.
\]
with the associated matrix
\[
    \begin{pmatrix}
        1 & 0 & 0 & 0 \\
        0 & 2 & 0 & 0 \\
        0 & 0 & 2 & 2 \\
        0 & 0 & 2 & 28
    \end{pmatrix}.
\]
This in turn is isomorphic to
\[
    \begin{pmatrix}
        1 & 0 & 0 & 0 \\
        0 & 2 & 0 & 0 \\
        0 & 0 & 2 & 0 \\
        0 & 0 & 0 & 26
    \end{pmatrix}.
\]
Hence we have \(m = 26\) in this case. Continuing these calculations for all
escalations of \(\Lattice_3\), we find that \(m \leq 28\) and \(\Lattice_3\)
represents all integers less than \(4 \cdot 28 = 112\). It follows that any
escalator arising from \(\Lattice_3\) for which \(m \not\equiv 0 \pmod{8}\) is
universal.

If \(m\) is a multiple of \(8\), then the lattice \(\Lattice_3\) is called
``exceptional.'' Out of the \(26\) escalations of \(\Lattice_3\), it turns out
that exactly two are exceptional. For each of these lattices, we find new
three-dimensional sublattices \(\Lattice_3'\) which are unique in their genus
and apply the same argument as above. For example, consider the escalation
\[
    \begin{pmatrix}
        1 & 0 & 0 & 0 \\
        0 & 2 & 0 & 1 \\
        0 & 0 & 2 & 2 \\
        0 & 1 & 2 & 7
    \end{pmatrix}.
\]
We note that the lattice \(\Lattice_3'\) with Gram matrix
\[
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 2 & 1 \\
        0 & 1 & 3
    \end{pmatrix}
\]
lies in \(\Lattice'_4\) and is unique in its genus. By direct calculation, we
find that \(\Lattice_3'\) represents all integers except those of the form
\(5^d\tau_{+}\) where \(d\) is odd and \(\tau_{+}\) is a quadratic residue
modulo \(5\), so that writing \(\tau\) to be the truant of \(\Lattice_4'\),
\(\tau\) is thus of this form. Similarly, we have \(m = 40\) (using the same
notation above) and either \(\tau - m\) or \(\tau - 4m\) is not of the form
\(5^d\tau_{+}\). Calculating up to \(160\) shows that \(\Lattice_4'\) is
universal. 

Exceptional lattices arise only from the lattices with Gram matrices
\[
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 2 & 0 \\
        0 & 0 & 2
    \end{pmatrix}, \quad
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 2 & 1 \\
        0 & 1 & 4
    \end{pmatrix}, \quad
    \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 2 & 0 \\
        0 & 0 & 4
    \end{pmatrix}.
\]
Each can be handled in the same way as above, thus proving the universality of
all but six of the \(207\) escalator lattices.


\section{Universal escalators and the fifteen theorem}