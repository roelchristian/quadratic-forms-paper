\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{amsfonts}
\RequirePackage{amsthm}


\RequirePackage[backend=biber]{biblatex}
\RequirePackage[pagestyles]{titlesec}
\RequirePackage{xcolor}
\RequirePackage{titletoc}

\RequirePackage{hyperref}
\hypersetup{
    colorlinks = true,
    linkcolor = green!50!black,
    anchorcolor = green!50!black,
    citecolor = green!50!black,
    filecolor = green!50!black,
    urlcolor = green!50!black
    }

\RequirePackage{graphicx}
\RequirePackage{subcaption}
\renewcommand{\figurename}{Fig.}
\renewcommand{\contentsname}{Contents.}
\renewcommand{\listfigurename}{List of figures.}
\DeclareCaptionFormat{custom}
{%
    {\footnotesize{\lsstylehelp{150}\scshape{{#1#2}}}\textit{#3}}
}
\captionsetup{format=custom}

\RequirePackage{enumitem}

\RequirePackage{tabularx}


% Only list chapters and sections in the ToC
\setcounter{tocdepth}{1}

% Section format in ToC
\titlecontents{section}
    [0pt]
    {}
    {\quad}
    {}
    {\titlerule*[1pc]{.}\contentspage}



\RequirePackage{fancyhdr}
\RequirePackage{extramarks}
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\fancyhead[LE,RO]{\footnotesize\thepage}
\fancyhead[CE]{\scshape \MakeLowercase{\leftmark}}
\fancyhead[CO]{\scshape\MakeLowercase{\rightmark}}

\makeatletter
\renewcommand{\chaptermark}[1]{%
  \markboth{%
    \ifnum\c@secnumdepth>\m@ne
      \@chapapp\ {\small\thechapter}. \ %
    \fi
  #1%
  }{}%
}
\makeatother

\makeatletter
\renewcommand{\chaptermark}[1]{%
        \markboth{\thechapter.\ #1}{}}
% unnumbered chapters in the header
\renewcommand{\chaptermark}[1]{%
        \markboth{#1}{}}
        
\renewcommand{\sectionmark}[1]{\markright{\small #1}}
\renewcommand{\thepage}{\footnotesize\arabic{page}}
\makeatother



\RequirePackage[norule,symbol,perpage]{footmisc}
\RequirePackage{microtype}
\SetTracking{encoding=*, shape=sc}{60}
\widowpenalty10000
\clubpenalty10000
\usepackage{url}
\urlstyle{same}

% \RequirePackage[
%   oldstylenums, largesmallcaps
% ]{kpfonts}



\usepackage[math-style=ISO]{unicode-math}
\defaultfontfeatures{Mapping=tex-text}
\DisableLigatures{encoding = *, shape = sc*}
\setmainfont[Ligatures={Common,TeX},
SmallCapsFeatures={
  LetterSpace=7.5
}
]{Linux Libertine O}
\setmathfont[Scale=0.97,Ligatures=TeX,
math-style=TeX
]{Libertinus Math}
\setmathfont[range=it/{Latin,latin}]{Linux Libertine O Italic}
% \setmathfont[range=up]{Junicode}
% \setmathfont[range=it/{Greek, greek}]{Linux Libertine O Italic}
\setmathfont[range=up/{Greek, greek}]{Linux Libertine O}
\setmathfont[range=it/{Greek, greek}]{Linux Libertine O Italic}
\setmathfont[range=frak/{latin,Latin},
                   Scale=MatchUppercase,
                   StylisticSet=1,
                   script-features={},
                   sscript-features={}
            ]{Unifraktur Maguntia}

% Theorem environments
\theoremstyle{plain}
\newtheorem*{theorem}{theorem}
\newtheorem*{lemma}{lemma}
\newtheorem*{corollary}{corollary}
% Numbered theorems
\newtheorem{theoremx}{theorem}[subsection]
\newtheorem{lemmax}{lemma}[subsection]
\newtheorem{corollaryx}{corollary}[subsection]
\newtheorem{corollaryb}{corollary}[subsection]



\theoremstyle{definition}
\newtheorem*{definition}{definition}

% Commands
\newcommand{\Integers}{\mathbb{Z}}
\newcommand{\Naturals}{\mathbb{N}}
\newcommand{\Reals}{\mathbb{R}}
\newcommand{\Complex}{\mathbb{C}}
\newcommand{\Rationals}{\mathbb{Q}}
\DeclareRobustCommand{\RationalsHead}{\mathbb{Q}}
\DeclareRobustCommand{\FiniteHead}{\mathbb{F}}

\newcommand{\transp}{\mathsf{T}}
\newcommand{\genlin}[2]{\mathrm{GL}_{#1}(#2)}
\newcommand{\SL}{\mathrm{SL}}
\newcommand{\charx}{\operatorname{char}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\field}{\mathsf{k}}
\newcommand{\Span}[1]{\operatorname{span} #1}
\newcommand{\Radical}[1]{\operatorname{rad} #1}
\newcommand{\Units}{\mathbb{Z}_p^{\times}}
\newcommand{\fieldU}{\field^{\times}}
\newcommand{\SquareClass}{\field^{\times}/\field^{\times2}}
\newcommand{\FiniteField}{\mathbb{F}}
\newcommand{\discr}{{\Delta}}
\newcommand{\quadform}[1]{\langle #1 \rangle}
\newcommand{\Places}{\mathfrak{V}}
\newcommand{\Basis}{\mathfrak{B}}
\newcommand{\Lattice}{\Lambda}
\newcommand{\genus}{\mathcal{G}}


\renewenvironment{proof}{{\itshape Proof. }}{{\scshape q.e.d.}}

\RequirePackage{longtable}

\AtBeginDocument{
    \let\phi\varphi
    \let\epsilon\varepsilon
    \let\iff\Leftrightarrow
    \let\implies\Rightarrow
    \let\leq\leqslant
    \let\geq\geqslant
    \let\theta\vartheta
}
